<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SALAHELDIN | TradeZella Pro+</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<style>
:root{
--bg:#09090b;--card:#121214;--border:#27272a;
--primary:#8b5cf6;--green:#10b981;--red:#ef4444;
--text:#fafafa;--muted:#a1a1aa;
}
body{margin:0;font-family:Inter;background:var(--bg);color:var(--text);padding:10px}
.card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:15px;margin-bottom:15px}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:10px}
input,select,textarea,button{
width:100%;padding:10px;border-radius:8px;border:1px solid var(--border);
background:#18181b;color:#fff
}
button{background:var(--primary);border:none;font-weight:bold;cursor:pointer}
.win{color:var(--green)} .loss{color:var(--red)}
table{width:100%;border-collapse:collapse;font-size:12px}
th,td{padding:8px;border-bottom:1px solid var(--border)}
</style>
</head>

<body>

<!-- Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„ -->
<div class="card">
<b>ğŸ’° Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„</b>
<input id="capital" type="number" placeholder="Account Size ($)">
<button onclick="saveCapital()">Ø­ÙØ¸</button>
</div>

<!-- ÙÙ„Ø§ØªØ± -->
<div class="card">
<select id="filter" onchange="render()">
<option value="all">Ø§Ù„ÙƒÙ„</option>
<option value="day">Ø§Ù„ÙŠÙˆÙ…</option>
<option value="week">Ø§Ù„Ø£Ø³Ø¨ÙˆØ¹</option>
<option value="month">Ø§Ù„Ø´Ù‡Ø±</option>
</select>
</div>

<!-- Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª -->
<div class="card grid">
<div>Net P&L<br><b id="net"></b></div>
<div>Return %<br><b id="return"></b></div>
<div>Drawdown %<br><b id="dd"></b></div>
<div>Trades<br><b id="count"></b></div>
</div>

<!-- Ø´Ø§Ø±Øª -->
<div class="card"><canvas id="chart"></canvas></div>

<!-- Ø¥Ø¶Ø§ÙØ© / ØªØ¹Ø¯ÙŠÙ„ -->
<div class="card">
<input id="symbol" placeholder="Symbol">
<select id="side"><option>Long</option><option>Short</option></select>
<input id="pnl" type="number" placeholder="P&L">
<select id="mistake">
<option value="">No Mistake</option>
<option>FOMO</option>
<option>Overtrade</option>
<option>Revenge</option>
<option>No Plan</option>
</select>
<button onclick="saveTrade()">Save</button>
</div>

<!-- Ø¬Ø¯ÙˆÙ„ -->
<div class="card">
<table>
<thead>
<tr><th>Symbol</th><th>P&L</th><th>âœï¸</th><th>ğŸ—‘</th></tr>
</thead>
<tbody id="rows"></tbody>
</table>
<button onclick="exportCSV()">â¬‡ï¸ Export CSV</button>
</div>

<script>
let trades=JSON.parse(localStorage.getItem('trades'))||[];
let capital=+localStorage.getItem('capital')||0;
let editIndex=null;
let chart;

capitalInput.value=capital||'';

function saveCapital(){
capital=+capitalInput.value;
localStorage.setItem('capital',capital);
render();
}

function saveTrade(){
const t={
symbol:symbol.value,
side:side.value,
pnl:+pnl.value,
mistake:mistake.value,
date:new Date().toISOString()
};
if(editIndex!==null){trades[editIndex]=t;editIndex=null;}
else trades.push(t);
localStorage.setItem('trades',JSON.stringify(trades));
symbol.value=pnl.value='';
render();
}

function filterTrades(){
const f=filter.value;
const now=new Date();
return trades.filter(t=>{
const d=new Date(t.date);
if(f==='day') return d.toDateString()===now.toDateString();
if(f==='week') return (now-d)/(1000*60*60*24)<=7;
if(f==='month') return d.getMonth()===now.getMonth();
return true;
});
}

function render(){
const list=filterTrades();
rows.innerHTML='';
let sum=0,eq=[0],dd=0,peak=0;

list.forEach((t,i)=>{
sum+=t.pnl; eq.push(sum);
peak=Math.max(peak,sum);
dd=Math.min(dd,sum-peak);
rows.innerHTML+=`
<tr>
<td>${t.symbol}</td>
<td class="${t.pnl>=0?'win':'loss'}">${t.pnl}</td>
<td onclick="edit(${i})">âœï¸</td>
<td onclick="del(${i})">ğŸ—‘</td>
</tr>`;
});

net.innerText=sum;
count.innerText=list.length;
return.innerText=capital?((sum/capital)*100).toFixed(2)+'%':'-';
dd.innerText=capital?((dd/capital)*100).toFixed(2)+'%':'-';
draw(eq);
}

function draw(d){
if(chart)chart.destroy();
chart=new Chart(chartCanvas,{
type:'line',
data:{labels:d.map((_,i)=>i),datasets:[{data:d,borderColor:'#8b5cf6',fill:true}]},
options:{plugins:{legend:{display:false}}}
});
}

function edit(i){
const t=trades[i];
symbol.value=t.symbol;
side.value=t.side;
pnl.value=t.pnl;
mistake.value=t.mistake;
editIndex=i;
}

function del(i){
trades.splice(i,1);
localStorage.setItem('trades',JSON.stringify(trades));
render();
}

function exportCSV(){
let csv="Symbol,Side,PnL,Mistake,Date\n";
trades.forEach(t=>csv+=`${t.symbol},${t.side},${t.pnl},${t.mistake},${t.date}\n`);
let a=document.createElement('a');
a.href=URL.createObjectURL(new Blob([csv],{type:'text/csv'}));
a.download='trades.csv';
a.click();
}

render();
</script>
</body>
</html>
